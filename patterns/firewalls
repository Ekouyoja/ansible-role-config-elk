#########################
## Firewalls Fortigate ##
#########################

FORTIGATE_ID [0-9]{10}
# TODO : on suppose que les chaînes non quotées ne contiennent pas de quotes et on n'échappe pas les caractères
# TODO : prendre en compte certaines chaînes non échappées qui contiennent des espaces (service=JBOSS ADMIN)
FORTIGATE_ENTRYPOINT [^(]+
FORTIGATE_FIELDNAME [^= ]+
FORTIGATE_NSTRING [^" ]*
FORTIGATE_QSTRING [^"]*
FORTIGATE_STRING %{FORTIGATE_NSTRING}|"%{FORTIGATE_QSTRING}"
FORTIGATE_DATE %{YEAR}-%{MONTHNUM}-%{MONTHDAY}
FORTIGATE_TIME %{HOUR}:%{MINUTE}:%{SECOND}
FORTIGATE_LEVEL emerg|alert|critical|error|warning|notice|information
FORTIGATE_TYPE traffic|event|virus|webfilter|ips|emailfilter|content|voip|dlp|app-ctrl|netscan
# Les sous-types valides dépendent du type
FORTIGATE_SUBTYPE allowed|local|multicast|forward|sniffer|app-ctrl|virus|dlp|emailfilter|utm|ips|endpoint|gtp|router|system|user|vpn|wad|wireless|dns|his-performance|other
FORTIGATE_TRAN_DISP noop|snat|dnat|snat\+dnat
# Déclarations spécifiques pour éliminer les quotes en trop. Ceci permet d'éliminer les quotes avant et après (mais pas les quotes internes)

FORTIGATE_FIELD_UI %{FORTIGATE_ENTRYPOINT:[fortigate][ui][name]}\(%{IP:[fortigate][ui][ip]}\)
FORTIGATE_FIELD_DNS_IP %{IP}(?:,%{IP})*
FORTIGATE_FIELD_DNS_NAME "%{FORTIGATE_QSTRING:[fortigate][dns][name]}"|%{FORTIGATE_NSTRING:[fortigate][dns][name]}
FORTIGATE_FIELD_USER "%{FORTIGATE_QSTRING:[fortigate][user]}"|%{FORTIGATE_NSTRING:[fortigate][user]}
FORTIGATE_FIELD_GROUP "%{FORTIGATE_QSTRING:[fortigate][group]}"|%{FORTIGATE_NSTRING:[fortigate][group]}
FORTIGATE_FIELD_VD "%{FORTIGATE_QSTRING:[fortigate][vd]}"|%{FORTIGATE_NSTRING:[fortigate][vd]}
FORTIGATE_FIELD_APP_NAME "%{FORTIGATE_QSTRING:[fortigate][app_name]}"|%{FORTIGATE_NSTRING:[fortigate][app_name]}
FORTIGATE_FIELD_SRC_COUNTRY "%{FORTIGATE_QSTRING:[fortigate][src][country]}"|%{FORTIGATE_NSTRING:[fortigate][src][country]}
FORTIGATE_FIELD_DST_COUNTRY "%{FORTIGATE_QSTRING:[fortigate][dst][country]}"|%{FORTIGATE_NSTRING:[fortigate][dst][country]}
FORTIGATE_FIELD_SRC_INT "%{FORTIGATE_QSTRING:[fortigate][src][intf]}"|%{FORTIGATE_NSTRING:[fortigate][src][intf]}
FORTIGATE_FIELD_DST_INT "%{FORTIGATE_QSTRING:[fortigate][dst][intf]}"|%{FORTIGATE_NSTRING:[fortigate][dst][intf]}
FORTIGATE_FIELD_SERVICE "%{FORTIGATE_QSTRING:[fortigate][service]}"|%{FORTIGATE_NSTRING:[fortigate][service]}
FORTIGATE_FIELD_TRAN_IP "%{IP:[fortigate][tran][dst][ip]}"|%{IP:[fortigate][tran][dst][ip]}
FORTIGATE_FIELD_TRAN_SIP "%{IP:[fortigate][tran][src][ip]}"|%{IP:[fortigate][tran][src][ip]}
FORTIGATE_FIELD_ACTION "%{FORTIGATE_QSTRING:[fortigate][action]}"|%{FORTIGATE_NSTRING:[fortigate][action]}
FORTIGATE_FIELD_LOGDESC "%{FORTIGATE_QSTRING:[fortigate][logdesc]}"|%{FORTIGATE_NSTRING:[fortigate][logdesc]}
FORTIGATE_FIELD_PROFILE "%{FORTIGATE_QSTRING:[fortigate][profile][name]}"|%{FORTIGATE_NSTRING:[fortigate][profile][name]}
FORTIGATE_FIELD_MSG "%{FORTIGATE_QSTRING:[fortigate][msg]}"|%{FORTIGATE_NSTRING:[fortigate][msg]}

# TODO : les chaînes ne sont pas forcément toujours quotées ou non
FORTIGATE (?:(?:date=%{FORTIGATE_DATE:[fortigate][date]}|time=%{FORTIGATE_TIME:[fortigate][time]}|devname=%{FORTIGATE_STRING:[fortigate][devname]}|dev(?:ice_)?id=%{FORTIGATE_STRING:[fortigate][device_id]}|log_?id=%{FORTIGATE_ID:[fortigate][logid]:int}|type=%{FORTIGATE_TYPE:[fortigate][type]}|subtype=%{FORTIGATE_SUBTYPE:[fortigate][subtype]}|level=%{FORTIGATE_LEVEL:[fortigate][level]}|vd=%{FORTIGATE_FIELD_VD}|src(?:ip)?=%{IPV4:[fortigate][src][ip]}|src(?:intf|_int)=%{FORTIGATE_FIELD_SRC_INT}|dst(?:ip)?=%{IPV4:[fortigate][dst][ip]}|dst(?:intf|_int)=%{FORTIGATE_FIELD_DST_INT}|sessionid=%{UINT:[fortigate][session]:int}|status=%{FORTIGATE_STRING:[fortigate][status]}|policyid=%{UINT:[fortigate][policyid]:int}|dst_?country=%{FORTIGATE_FIELD_DST_COUNTRY}|src_?country=%{FORTIGATE_FIELD_SRC_COUNTRY}|tran_?disp=%{FORTIGATE_TRAN_DISP:[fortigate][tran][disp]}|tran_?ip=%{FORTIGATE_FIELD_TRAN_IP}|tran_?port=%{UINT:[fortigate][tran][dst][port]:int}|tran_?sip=%{FORTIGATE_FIELD_TRAN_SIP}|tran_?sport=%{UINT:[fortigate][tran][src][port]:int}|service=%{FORTIGATE_FIELD_SERVICE}|proto=%{UINT:[fortigate][proto]:int}|duration=%{UINT:[fortigate][duration]:int}|sent(?:byte)?=%{UINT:[fortigate][sentbyte]:int}|rcvd(?:byte)?=%{UINT:[fortigate][rcvdbyte]:int}|sent_?pkt=%{UINT:[fortigate][sentpkt]:int}|rcvd_?pkt=%{UINT:[fortigate][rcvdpkt]:int}|dst_?port=%{UINT:[fortigate][dst][port]:int}|src_?port=%{UINT:[fortigate][src][port]:int}|dstname=%{FORTIGATE_STRING:[fortigate][dst][name]}|srcname=%{FORTIGATE_STRING:[fortigate][src][name]}|pri=%{FORTIGATE_LEVEL:[fortigate][pri]}|SN=%{UINT:[fortigate][serial_number]:int}|crlevel=%{FORTIGATE_STRING}|msg=%{FORTIGATE_FIELD_MSG}|poluuid=%{UUID:[fortigate][policy_uuid]}|dir_disp=%{FORTIGATE_STRING:[fortigate][dir_disp]}|crscore=%{UINT:[fortigate][crscore]:int}|craction=%{UINT:[fortigate][craction]:int}|crlevel=%{FORTIGATE_STRING:[fortigate][crlevel]}|action=%{FORTIGATE_FIELD_ACTION}|user=%{FORTIGATE_FIELD_USER}|group=%{FORTIGATE_FIELD_GROUP}|dns_name=%{FORTIGATE_FIELD_DNS_NAME}|dns_ip=%{FORTIGATE_FIELD_DNS_IP:[fortigate][dns][ip_raw]}|utmaction=%{FORTIGATE_STRING:[fortigate][utm_action]}|utmevent=%{FORTIGATE_STRING:[fortigate][utm_event]}|attack=%{FORTIGATE_STRING:[fortigate][attack]}|app_?act=%{FORTIGATE_STRING:[fortigate][app_act]}|app_?cat=%{FORTIGATE_STRING:[fortigate][app_cat]}|app=%{FORTIGATE_FIELD_APP_NAME}|app_?list=%{FORTIGATE_STRING:[fortigate][app_list]}|app_?id=%{UINT:[fortigate][app_id]:int}|app_?type=%{FORTIGATE_STRING:[fortigate][app_type]}|hostname=%{FORTIGATE_STRING:[fortigate][hostname]}|reason=%{FORTIGATE_STRING:[fortigate][reason]}|log=%{FORTIGATE_STRING:[fg][log]}|cpu=%{UINT:[fortigate][cpu]:int}|mem=%{UINT:[fortigate][mem]:int}|total_?session=%{UINT:[fortigate][totalsession]:int}|carrier_?ep=%{FORTIGATE_STRING:[fortigate][radius][carrier_ep]}|profile_?group=%{FORTIGATE_STRING:[fortigate][profile][group]}|profile_?type=%{FORTIGATE_STRING:[fortigate][profile][type]}|profile=%{FORTIGATE_FIELD_PROFILE}|shaper(?:_drop_sent|droprcvdbyte)=%{UINT:[fortigate][shaper][droprcvdbyte]}|shaper(?:_drop_rcvd|dropsentbyte)=%{UINT:[fortigate][shaper][dropsentbyte]}|shaper(?:_rcvd_name|rcvdname)=%{FORTIGATE_STRING:[fortigate][shaper][rcvdname]}|shaper(?:_sent_name|sentname)=%{FORTIGATE_STRING:[fortigate][shaper][sentname]}|(?:perip_drop|shaperperipdropbyte)=%{UINT:[fortigate][shaper][per_ip][dropbyte]}|(?:perip_name|shaperperipname)=%{FORTIGATE_STRING:[fortigate][shaper][per_ip][name]}|vpn=%{FORTIGATE_STRING:[fortigate][vpn][name]}|vpn_?tunnel=%{FORTIGATE_STRING:[fortigate][vpn][tunnel]}|vpn_?type=%{FORTIGATE_STRING:[fortigate][vpn][type]}|subapp=%{FORTIGATE_STRING:[fortigate][subapp][name]}|subapp_?cat=%{FORTIGATE_STRING:[fortigate][subapp][cat]}|rule=%{UINT:[fortigate][rule]:int}|identidx=%{UINT:[fortigate][identidx]:int}|ui=%{FORTIGATE_FIELD_UI}|disk=%{UINT:[fortigate][disk]:int}|setuprate=%{UINT:[fortigate][setuprate]:int}|disklograte=%{UINT:[fortigate][disklograte]:int}|fazlograte=%{UINT:[fortigate][fazlograte]:int}|bandwidth=%{UINT:[fortigate][bandwidth][in]:int}/%{UINT:[fortigate][bandwidth][out]:int}|logdesc=%{FORTIGATE_FIELD_LOGDESC}|%{FORTIGATE_FIELDNAME:[fortigate][unknown_field]}=%{FORTIGATE_STRING})[ ]?)*

#########################
## Format CEF Arcsight ##
#########################

# d'après les spécifications (Arcsight) publiées par HP le 06/11/2015
CEF_VERSION 0
CEF_EXT_VALUE (?:[^=\\]|\\[=nr\\])*
CEF_HEADER_VALUE (?:[^\\|]|\\(?:\\|\|))*
CEF_SEVERITY_NUM 0|10?|[2-9]
CEF_SEVERITY_STR Unknown|Low|Medium|High|Very-High
CEF_HEADER_SEVERITY %{CEF_SEVERITY_NUM:[cef][severity][code]:int}|%{CEF_SEVERITY_STR:[cef][severity][label]}
CEF_EXT %{CEF_EXT_FIELD}(?: %{CEF_EXT_FIELD})*
CEF_EXT_FIELD a(?:ct=%{CEF_EXT_VALUE:[cef][ext][act]}|pp=%{CEF_EXT_VALUE:[cef][ext][app]}|gt=%{CEF_EXT_VALUE:[cef][ext][agent][address]}|host=%{CEF_EXT_VALUE:[cef][ext][agent][host]}|id=%{CEF_EXT_VALUE:[cef][ext][agent][id]}|mac=%{CEF_EXT_VALUE:[cef][ext][agent][mac]}|rt=%{CEF_EXT_VALUE:[cef][ext][agent][receipt_time]}|t(?:=%{CEF_EXT_VALUE:[cef][ext][agent][type]}|z=%{CEF_EXT_VALUE:[cef][ext][agent][timezone]})|v=%{CEF_EXT_VALUE:[cef][ext][agent][version]})|c(?:6a(?:1(?:=%{CEF_EXT_VALUE:[cef][ext][custom][ipv6_address][1][value]}|Label=%{CEF_EXT_VALUE:[cef][ext][custom][ipv6_address][1][label]})|2(?:=%{CEF_EXT_VALUE:[cef][ext][custom][ipv6_address][2][value]}|Label=%{CEF_EXT_VALUE:[cef][ext][custom][ipv6_address][2][label]})|3(?:=%{CEF_EXT_VALUE:[cef][ext][custom][ipv6_address][3][value]}|Label=%{CEF_EXT_VALUE:[cef][ext][custom][ipv6_address][3][label]})|4(?:=%{CEF_EXT_VALUE:[cef][ext][custom][ipv6_address][4][value]}|Label=%{CEF_EXT_VALUE:[cef][ext][custom][ipv6_address][4][label]}))|at=%{CEF_EXT_VALUE:[cef][ext][event_category]}|ustomer(?:ExternalID=%{CEF_EXT_VALUE:[cef][ext][customer][external_id]}|URI=%{CEF_EXT_VALUE:[cef][ext][customer][uri]})|fp(?:1(?:=%{CEF_EXT_VALUE:[cef][ext][custom][floating_point][1][value]:float}|Label=%{CEF_EXT_VALUE:[cef][ext][custom][floating_point][1][label]})|2(?:=%{CEF_EXT_VALUE:[cef][ext][custom][floating_point][2][value]:float}|Label=%{CEF_EXT_VALUE:[cef][ext][custom][floating_point][2][label]})|3(?:=%{CEF_EXT_VALUE:[cef][ext][custom][floating_point][3][value]:float}|Label=%{CEF_EXT_VALUE:[cef][ext][custom][floating_point][3][label]})|4(?:=%{CEF_EXT_VALUE:[cef][ext][custom][floating_point][4][value]:float}|Label=%{CEF_EXT_VALUE:[cef][ext][custom][floating_point][4][label]}))|n(?:1(?:=%{CEF_EXT_VALUE:[cef][ext][custom][number][1][value]:int}|Label=%{CEF_EXT_VALUE:[cef][ext][custom][number][1][label]})|2(?:=%{CEF_EXT_VALUE:[cef][ext][custom][number][2][value]:int}|Label=%{CEF_EXT_VALUE:[cef][ext][custom][number][2][label]})|3(?:=%{CEF_EXT_VALUE:[cef][ext][custom][number][3][value]:int}|Label=%{CEF_EXT_VALUE:[cef][ext][custom][number][3][label]})|t=%{CEF_EXT_VALUE:[cef][ext][event_count]:int})|s(?:1(?:=%{CEF_EXT_VALUE:[cef][ext][custom][string][1][value]}|Label=%{CEF_EXT_VALUE:[cef][ext][custom][string][1][label]})|2(?:=%{CEF_EXT_VALUE:[cef][ext][custom][string][2][value]}|Label=%{CEF_EXT_VALUE:[cef][ext][custom][string][2][label]})|3(?:=%{CEF_EXT_VALUE:[cef][ext][custom][string][3][value]}|Label=%{CEF_EXT_VALUE:[cef][ext][custom][string][3][label]})|4(?:=%{CEF_EXT_VALUE:[cef][ext][custom][string][4][value]}|Label=%{CEF_EXT_VALUE:[cef][ext][custom][string][4][label]})|5(?:=%{CEF_EXT_VALUE:[cef][ext][custom][string][5][value]}|Label=%{CEF_EXT_VALUE:[cef][ext][custom][string][5][label]})|6(?:=%{CEF_EXT_VALUE:[cef][ext][custom][string][6][value]}|Label=%{CEF_EXT_VALUE:[cef][ext][custom][string][6][label]})))|d(?:estination(?:DnsDomain=%{CEF_EXT_VALUE:[cef][ext][destination][dns_domain]}|ServiceName=%{CEF_EXT_VALUE:[cef][ext][destination][service_name]}|Translated(?:Address=%{CEF_EXT_VALUE:[cef][ext][destination][translated_address]}|Port=%{UINT:[cef][ext][destination][translated_port]:int}|Zone(?:ExternalID=%{CEF_EXT_VALUE:[cef][ext][destination][translated_zone_external_id]}|URI=%{CEF_EXT_VALUE:[cef][ext][destination][translated_zone_uri]}))|Zone(?:ExternalID=%{CEF_EXT_VALUE:[cef][ext][destination][zone_external_id]}|URI=%{CEF_EXT_VALUE:[cef][ext][destination][zone_uri]}))|evice(?:Custom(?:Date(?:1(?:=%{CEF_EXT_VALUE:[cef][ext][custom][date][1][value]}|Label=%{CEF_EXT_VALUE:[cef][ext][custom][date][1][label]})|2(?:=%{CEF_EXT_VALUE:[cef][ext][custom][date][2][value]}|Label=%{CEF_EXT_VALUE:[cef][ext][custom][date][2][label]})))|D(?:irection=%{CEF_EXT_VALUE:[cef][ext][direction]:int}|nsDomain=%{CEF_EXT_VALUE:[cef][ext][dns_domain]})|ExternalId=%{CEF_EXT_VALUE:[cef][ext][external_id]}|Facility=%{CEF_EXT_VALUE:[cef][ext][facility]}|InboundInterface=%{CEF_EXT_VALUE:[cef][ext][inbound_interface]}|NtDomain=%{CEF_EXT_VALUE:[cef][ext][nt_domain]}|OutboundInterface=%{CEF_EXT_VALUE:[cef][ext][outbound_interface]}|P(?:ayloadId=%{CEF_EXT_VALUE:[cef][ext][payload_id]}|rocessName=%{CEF_EXT_VALUE}:[cef][ext][process_name])|Translated(?:Address=%{CEF_EXT_VALUE:[cef][ext][translated_address]}|Zone(?:ExternalID=%{CEF_EXT_VALUE:[cef][ext][translated_zone_external_id]}|URI=%{CEF_EXT_VALUE:[cef][ext][translated_zone_uri]}))|Zone(?:ExternalID=%{CEF_EXT_VALUE:[cef][ext][zone_external_id]}|URI=%{CEF_EXT_VALUE:[cef][ext][zone_uri]}))|host=%{CEF_EXT_VALUE:[cef][ext][destination][host]}|mac=%{CEF_EXT_VALUE:[cef][ext][destination][mac]}|ntdom=%{CEF_EXT_VALUE:[cef][ext][destination][nt_domain]}|p(?:id=%{CEF_EXT_VALUE:[cef][ext][destination][process_id]:int}|r(?:iv=%{CEF_EXT_VALUE:[cef][ext][destination][user_privileges]}|oc=%{CEF_EXT_VALUE:[cef][ext][destination][process_name]})|t=%{UINT:[cef][ext][destination][port]:int})|st=%{CEF_EXT_VALUE:[cef][ext][destination][address]}|tz=%{CEF_EXT_VALUE:[cef][ext][timezone]}|u(?:id=%{CEF_EXT_VALUE:[cef][ext][destination][user_id]}|ser=%{CEF_EXT_VALUE:[cef][ext][destination][user_name]})|vc(?:=%{CEF_EXT_VALUE:[cef][ext][address]}|host=%{CEF_EXT_VALUE:[cef][ext][hostname]}|mac=%{CEF_EXT_VALUE:[cef][ext][mac]}|pid=%{CEF_EXT_VALUE:[cef][ext][process_id]:int}))|e(?:nd=%{CEF_EXT_VALUE:[cef][ext][end_time]}|xternalId=%{CEF_EXT_VALUE:[cef][ext][external_id]})|f(?:ile(?:CreateTime=%{CEF_EXT_VALUE:[cef][ext][file][create_time]}|Hash=%{CEF_EXT_VALUE:[cef][ext][file][hash]}|Id=%{CEF_EXT_VALUE:[cef][ext][file][id]}|ModificationTime=%{CEF_EXT_VALUE:[cef][ext][file][modification_time]}|P(?:ath=%{CEF_EXT_VALUE:[cef][ext][file][path]}|ermission=%{CEF_EXT_VALUE:[cef][ext][file][permission]})|Type=%{CEF_EXT_VALUE:[cef][ext][file][type]})|lex(?:Date(?:1(?:=%{CEF_EXT_VALUE:[cef][ext][flex][date][1][value]}|Label=%{CEF_EXT_VALUE:[cef][ext][flex][date][1][label]}))|Number(?:1(?:=%{CEF_EXT_VALUE:[cef][ext][flex][number][1][value]}|Label=%{CEF_EXT_VALUE:[cef][ext][flex][number][1][label]})|2(?:=%{CEF_EXT_VALUE:[cef][ext][flex][number][2][value]}|Label=%{CEF_EXT_VALUE:[cef][ext][flex][number][2][label]}))|String(?:1(?:=%{CEF_EXT_VALUE:[cef][ext][flex][string][1][value]}|Label=%{CEF_EXT_VALUE:[cef][ext][flex][string][1][label]})|2(?:=%{CEF_EXT_VALUE:[cef][ext][flex][string][2][value]}|Label=%{CEF_EXT_VALUE:[cef][ext][flex][string][2][label]})))|name=%{CEF_EXT_VALUE:[cef][ext][file][name]}|size=%{CEF_EXT_VALUE:[cef][ext][file][size]:int})|in=%{UINT:[cef][ext][bytes_in]:int}|msg=%{CEF_EXT_VALUE:[cef][ext][message]}|o(?:ldFile(?:CreateTime=%{CEF_EXT_VALUE:[cef][ext][oldfile][create_time]}|Hash=%{CEF_EXT_VALUE:[cef][ext][oldfile][hash]}|Id=%{CEF_EXT_VALUE:[cef][ext][oldfile][id]}|ModificationTime=%{CEF_EXT_VALUE:[cef][ext][oldfile][modification_time]}|Name=%{CEF_EXT_VALUE:[cef][ext][oldfile][name]}|P(?:ath=%{CEF_EXT_VALUE:[cef][ext][oldfile][path]}|ermission=%{CEF_EXT_VALUE:[cef][ext][oldfile][permission]})|Size=%{CEF_EXT_VALUE:[cef][ext][oldfile][size]:int}|Type=%{CEF_EXT_VALUE:[cef][ext][oldfile][type]})|ut(?:=%{UINT:[cef][ext][bytes_out]:int}|come=%{CEF_EXT_VALUE:[cef][ext][event_outcome]}))|proto=%{UINT:[cef][ext][protocol]:int}|r(?:e(?:ason=%{CEF_EXT_VALUE:[cef][ext][reason]}|quest(?:=%{CEF_EXT_VALUE:[cef][ext][request][url]}|C(?:lientApplication=%{CEF_EXT_VALUE:[cef][ext][request][client_application]}|o(?:ntext=%{CEF_EXT_VALUE:[cef][ext][request][context]}|okies=%{CEF_EXT_VALUE:[cef][ext][request][cookies]}))|Method=%{CEF_EXT_VALUE:[cef][ext][request][method]}|URL=%{CEF_EXT_VALUE:[cef][ext][request][url]}))|t=%{CEF_EXT_VALUE:[cef][ext][receipt_time]})|s(?:host=%{CEF_EXT_VALUE:[cef][ext][source][host]}|mac=%{CEF_EXT_VALUE:[cef][ext][source][mac]}|ntdom=%{CEF_EXT_VALUE:[cef][ext][source][nt_domain]}|ource(?:DnsDomain=%{CEF_EXT_VALUE:[cef][ext][source][dns_domain]}|ServiceName=%{CEF_EXT_VALUE:[cef][ext][source][service_name]}|Translated(?:Address=%{CEF_EXT_VALUE:[cef][ext][source][translated_address]}|Port=%{UINT:[cef][ext][source][translated_port]:int}|Zone(?:ExternalID=%{CEF_EXT_VALUE:[cef][ext][source][translated_zone_external_id]}|URI=%{CEF_EXT_VALUE:[cef][ext][source][translated_zone_uri]}))|Zone(?:ExternalID=%{CEF_EXT_VALUE:[cef][ext][source][zone_external_id]}|URI=%{CEF_EXT_VALUE:[cef][ext][source][zone_uri]}))|p(?:id=%{CEF_EXT_VALUE:[cef][ext][source][process_id]:int}|r(?:iv=%{CEF_EXT_VALUE:[cef][ext][source][user_privileges]}|oc=%{CEF_EXT_VALUE:[cef][ext][source][process_name]})|t=%{CEF_EXT_VALUE:[cef][ext][source][port]:int})|rc=%{CEF_EXT_VALUE:[cef][ext][source][address]}|tart=%{CEF_EXT_VALUE:[cef][ext][source][start_time]}|u(?:id=%{CEF_EXT_VALUE:[cef][ext][source][user_id]}|user=%{CEF_EXT_VALUE:[cef][ext][source][user_name]}))|type=%{CEF_EXT_VALUE:[cef][ext][type]:int}|agent(?:DnsDomain=%{CEF_EXT_VALUE:[cef][ext][agent][dns_domain]}|NtDomain=%{CEF_EXT_VALUE:[cef][ext][agent][nt_domain]}|Translated(?:Address=%{CEF_EXT_VALUE:[cef][ext][agent][translated_address]}|Zone(?:ExternalID=%{CEF_EXT_VALUE:[cef][ext][agent][translated_zone_external_id]}|URI=%{CEF_EXT_VALUE:[cef][ext][agent][translated_zone_uri]}))|Zone(?:ExternalID=%{CEF_EXT_VALUE:[cef][ext][agent][zone_external_id]}|URI=%{CEF_EXT_VALUE:[cef][ext][agent][zone_uri]}))|dl(?:at=%{CEF_EXT_VALUE:[cef][ext][destination][geo_lat]:float}|ong=%{CEF_EXT_VALUE:[cef][ext][destination][geo_long]:float})|eventId=%{CEF_EXT_VALUE:[cef][ext][event_id]:int}|rawEvent=%{CEF_EXT_VALUE:[cef][ext][raw_event]}|sl(?:at=%{CEF_EXT_VALUE:[cef][ext][source][geo_lat]:float}|ong=%{CEF_EXT_VALUE:[cef][ext][source][geo_lat]:float})
CEF CEF:%{CEF_VERSION}\|%{CEF_HEADER_VALUE:[cef][vendor]}\|%{CEF_HEADER_VALUE:[cef][product]}\|%{CEF_HEADER_VALUE:[cef][device_version]}\|%{CEF_HEADER_VALUE:[cef][sigid]:int}\|%{CEF_HEADER_VALUE:[cef][name]}\|%{CEF_HEADER_SEVERITY}\|%{CEF_EXT}
